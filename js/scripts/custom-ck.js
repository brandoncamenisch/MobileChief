jQuery(document).ready(function(e){function t(){e("body").tooltip({selector:"[rel=tooltip]"})}function n(){e(".dropdown-toggle").dropdown()}function r(){if(e(".plchf_msb_slider_field").length){e(".plchf_msb_slider_field").slider({range:"max",min:1,max:10,value:2,slide:function(t,n){e(".plchf_msb_slider_amount").val(n.value)}});e(".plchf_msb_slider_amount").val(e(".plchf_msb_slider_field").slider("value"))}}function i(){var t=e(".widget-action");t.live("click",function(t){t.preventDefault();e(this).parent().parent().next(".module-inside").slideToggle()})}function s(){e("textarea.tinymce").tinymce({script_url:pluginDir+"js/vendor-scripts/tiny_mce/tiny_mce.js",theme:"advanced",theme_advanced_buttons1:"formatselect,bold,italic,underline,strikethrough,justifyleft,justifycenter,justifyright,justifyfull",theme_advanced_buttons2:"styleselect,fontselect,fontsizeselect",theme_advanced_buttons3:"bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,forecolor,backcolor",theme_advanced_buttons4:"hr,removeformat,|,charmap,|,code",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:!0,content_css:pluginDir+"css/style.css"})}function o(){e(".datepicker").length&&e(".datepicker").datepicker()}function u(){e(".colorpicker").length&&e(".colorpicker").miniColors()}function a(){e("#page-generator, .section-sortable").length&&e("#page-generator, .section-sortable").sortable({connectWith:".connected-sortable",placeholder:"element-placeholder",items:".page-element, .page-section",handle:".element-move",start:function(t,n){e(this).find(".tinymce").each(function(){tinyMCE.execCommand("mceRemoveControl",!1,e(this).attr("id"))})},stop:function(t){e(this).find(".tinymce").each(function(){tinyMCE.execCommand("mceAddControl",!0,e(this).attr("id"));e(this).sortable("refresh")})}})}function f(){var t=e(".form-elements li a"),r=e("#page-generator");t.click(function(){var t=e("#page-generator").attr("data-postid"),i=e(this).attr("data-sectiontype"),f="pageid="+t+"&sectionType="+i+"&action=plchf_msb_add_section",l=e("#page-generator .element-placeholder");l.fadeOut();e.ajax({type:"POST",url:ajaxurl,data:f,handle:".element-move",success:function(t){e("body").find(".tinymce").each(function(){tinyMCE.execCommand("mceRemoveControl",!1,e(this).attr("id"))});r.prepend(t);g();u();o();s();a();n()}});return!1})}function l(){var t=e(".form-elements li a"),r=e("#page-generator");t.click(function(){var t=e("#page-generator").attr("data-postid"),i=e(this).attr("data-elementtype"),f="pageid="+t+"&elementType="+i+"&action=plchf_msb_add_element",l=e("#page-generator .element-placeholder");l.fadeOut();e.ajax({type:"POST",url:ajaxurl,data:f,handle:".element-move",success:function(t){e("body").find(".tinymce").each(function(){tinyMCE.execCommand("mceRemoveControl",!1,e(this).attr("id"))});r.prepend(t);u();o();s();a();n();L()}});return!1})}function c(){var t=e("#pluginchiefmsb-wrapper").html(),n=e(this).html();e(".mobile-preview-loader").fadeIn();e("#preview-frame").attr("src",e("#preview-frame").attr("src"));e(".mobile-preview-loader").delay(300).fadeOut()}function h(){e(".iphone-preview").waypoint(function(t,n){e(".iphone-preview").toggleClass("fixed",n==="down");t.stopPropagation()});e(".site-details").waypoint(function(t,n){e(".site-details").toggleClass("fixed",n==="down");t.stopPropagation()})}function p(){e(".upload_image_button").live("click",function(t){formfield=e(this).prev(".upload_image");tb_show("",""+adminRoot+"media-upload.php?type=image&amp;TB_iframe=true");return!1});window.send_to_editor=function(t){imgurl=e("img",t).attr("src");formfield.val(imgurl);tb_remove()}}function d(){var t=e(".element-open");t.live("click",function(t){t.preventDefault();e(this).parent().parent().parent().parent().next(".content").slideToggle()})}function v(){var t=e(".theme-detail");t.live("click",function(t){t.preventDefault();e(this).parent().parent().parent().next(".themedetaildiv").slideToggle()})}function m(){var t=e(".ajaxsave");t.live("click",function(e){e.preventDefault();g()})}function g(){var t=e("#page-generator").serialize(),n=e(".page-generator").attr("data-postid"),r=""+t+"&post_id="+n+"&action=plchf_msb_save_the_page_elements_ajax";toastr.warning("Your Settings Are Being Saved","Processing. . .");e("html, body").animate({scrollTop:e("#pluginchiefmsb-wrapper").offset().top},500);e(".page-element .content").slideUp(500);e.ajax({type:"POST",url:ajaxurl,data:r,success:function(e){toastr.success("Your Settings Have Been Saved","Success!");c();return!1}})}function y(){var t=e(".site-options-ajaxsave");t.live("click",function(e){e.preventDefault();b()})}function b(){var t=e("#site-settings").serialize(),n=e(".site-settings").attr("data-postid"),r=""+t+"&site_id="+n+"&action=plchf_msb_save_site_options_ajax";toastr.warning("Your Settings Are Being Saved","Processing. . .");e("html, body").animate({scrollTop:e("#pluginchiefmsb-wrapper").offset().top},500);e(".page-element .content").slideUp(500);e.ajax({type:"POST",url:ajaxurl,data:r,success:function(e){toastr.success("Your Settings Have Been Saved","Success!");c();return!1}})}function w(){var t=e(".deletesite");t.live("click",function(t){t.preventDefault();var n=e(this).data("siteid");e.confirm({title:"Delete Confirmation",message:"Are You Sure You Want to Delete this site? <br />All data will be lost. Continue?",buttons:{Yes:{"class":"btn btn-primary",action:function(){E(n)}},No:{"class":"btn btn-primary",action:function(){}}}})})}function E(t){var n="site_id="+t+"&action=plchf_msb_delete_site_ajax",r=e('[data-widgetid="'+t+'"]'),i=e(r).attr("data-redirectafterdelete");e.ajax({type:"POST",url:ajaxurl,data:n,success:function(e){r.fadeOut();window.location.replace(i);return!1}})}function S(){e(".element-remove").live("click",function(){var t=e(this).parent().parent().parent().parent().parent();e.confirm({title:"Delete Confirmation",message:"Are You Sure You Want to Remove This Element? <br />All data will be lost. Continue?",buttons:{Yes:{"class":"btn btn-primary",action:function(){t.slideUp(500,function(){t.remove();g()})}},No:{"class":"btn btn-primary",action:function(){}}}})})}function x(){var t=e("input.create-new-page");t.live("click",function(t){t.preventDefault();var n=e("#menu-manager").serialize(),r=e(".menu-builder .menu-container"),i=n+"&action=plchf_msb_create_new_page_with_ajax";e.ajax({type:"POST",url:ajaxurl,data:i,success:function(e){r.prepend(e);k();return!1}})})}function T(){var t=e(".deletepageself");t.live("click",function(t){t.preventDefault();var n=e(this).parent().parent().attr("data-id"),r="page_id="+n+"&action=plchf_msb_delete_mobile_site_page_self",i=e(this).parent().parent();e.confirm({title:"Delete Confirmation",message:"Are You Sure You Want to Delete This Page? <br />All data will be lost. Continue?",buttons:{Yes:{"class":"btn btn-primary",action:function(t){e.ajax({type:"POST",url:ajaxurl,data:r,success:function(e){window.location.replace(e);return!1}})}},No:{"class":"btn btn-primary",action:function(){}}}})})}function N(){var t=e(".deletepage");t.live("click",function(t){t.preventDefault();var n=e(this).parent().parent().attr("data-id"),r="page_id="+n+"&action=plchf_msb_delete_mobile_site_page",i=e(this).parent().parent();e.confirm({title:"Delete Confirmation",message:"Are You Sure You Want to Delete This Page? <br />All data will be lost. Continue?",buttons:{Yes:{"class":"btn btn-primary",action:function(t){e.ajax({type:"POST",url:ajaxurl,data:r,success:function(e){i.remove();k();return!1}})}},No:{"class":"btn btn-primary",action:function(){}}}})})}function C(){var t=e(".menu-container");t.sortable({handle:".menuitem-move",update:function(e,t){k()}})}function k(){var t=e(".menu-container");opts={url:ajaxurl,type:"POST",async:!0,cache:!1,dataType:"json",data:{action:"plchf_msb_pages_sort",order:t.sortable("toArray").toString()},success:function(e){c();return},error:function(e,t,n){c();return}};e.ajax(opts)}function L(){jQuery.fn.exists=function(){return jQuery(this).length>0};if(e(".plupload-upload-uic").exists()){var t=!1;e(".plupload-upload-uic").each(function(){var n=e(this),r=n.attr("id"),i=r.replace("plupload-upload-ui","");A(i);t=JSON.parse(JSON.stringify(base_plupload_config));t.browse_button=i+t.browse_button;t.container=i+t.container;t.drop_element=i+t.drop_element;t.file_data_name=i+t.file_data_name;t.multipart_params.imgid=i;t.multipart_params._ajax_nonce=n.find(".ajaxnonceplu").attr("id").replace("ajaxnonceplu","");n.hasClass("plupload-upload-uic-multiple")&&(t.multi_selection=!0);if(n.find(".plupload-resize").exists()){var s=parseInt(n.find(".plupload-width").attr("id").replace("plupload-width","")),o=parseInt(n.find(".plupload-height").attr("id").replace("plupload-height",""));t.resize={width:s,height:o,quality:90}}var u=new plupload.Uploader(t);u.bind("Init",function(e){});u.init();u.bind("FilesAdded",function(t,r){e.each(r,function(e,t){n.find(".filelist").append('<div class="file" id="'+t.id+'"><b>'+t.name+"</b> (<span>"+plupload.formatSize(0)+"</span>/"+plupload.formatSize(t.size)+") "+'<div class="fileprogress"></div></div>')});t.refresh();t.start()});u.bind("UploadProgress",function(t,n){e("#"+n.id+" .fileprogress").width(n.percent+"%");e("#"+n.id+" span").html(plupload.formatSize(parseInt(n.size*n.percent/100)))});u.bind("FileUploaded",function(t,r,s){e("#"+r.id).fadeOut();s=s.response;if(n.hasClass("plupload-upload-uic-multiple")){var o=e.trim(e("#"+i).val());o?o=o+","+s:o=s;e("#"+i).val(o)}else e("#"+i).val(s+"");A(i)})})}}function A(e){var t=jQuery,n=t("#"+e+"plupload-thumbs");n.html("");var r=t("#"+e).val(),i=r.split(",");for(var s=0;s<i.length;s++)if(i[s]){var o=t('<div class="thumb" id="thumb'+e+s+'"><img src="'+i[s]+'" alt="" /><div class="thumbi"><a id="thumbremovelink'+e+s+'" href="#">Remove</a></div> <div class="clear"></div></div>');n.append(o);o.find("a").click(function(){var n=t(this).attr("id").replace("thumbremovelink"+e,"");n=parseInt(n);var s=[];r=t("#"+e).val();i=r.split(",");for(var o=0;o<i.length;o++)o!=n&&(s[s.length]=i[o]);t("#"+e).val(s.join());A(e);return!1})}if(i.length>1){n.sortable({update:function(r,i){var s=[];n.find("img").each(function(){s[s.length]=t(this).attr("src");t("#"+e).val(s.join());A(e)})}});n.disableSelection()}}t();n();r();i();s();o();a();f();l();h();p();d();v();m();y();w();S();x();T();N();C();L()});